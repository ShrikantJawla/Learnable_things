<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('../common/commonHeader'); %>
</head>

<body>

    <div class="app align-content-stretch d-flex flex-wrap">
        <%- include('../common/commonSidebar' , {sidebarData : sidebarDataByServer}); %>
            <div class="app-container">
                <div class="loader-show" id="loader">
                    <div class="sbl-circ-path loader-content"></div>
                </div>

                <div class="app-content">
                    <h1 class="application-title">Export SMS file </h1>
                    <hr>
                    <div class="content-wrapper">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="text-center m-1 p-1">
                                                <div class="col-12" style="text-align: left;">
                                                    <form class="" id="demo-upload">

                                                        <!-- select banks here... -->

                                                        <div class="select-fields mb-4">
                                                            <h5 class="mb-4">Select Banks</h5>
                                                            <div class="row align-items-center">
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="all" name="selectAllBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Select All
                                                                    </label>
                                                                </div>
                                                                <% for(let i=0; i < allBanks.length; i++) {%>
                                                                    <div class="col-2 form-check m-3">
                                                                        <input class="form-check-input" type="checkbox"
                                                                            value="<%=allBanks[i]['bank_short_value'] %>"
                                                                            name="selectBanks">
                                                                        <label class="form-check-label"
                                                                            for="flexCheckDefault">
                                                                            <%=allBanks[i]['bank_name'] %>
                                                                        </label>
                                                                    </div>
                                                                    <%}%>
                                                                        <!-- <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="bob" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        BOB
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="sbi" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        SBI
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="icici" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        ICICI Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="au" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        AU Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="indusind" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        IndusInd
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="idfc" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        IDFC Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="hdfc" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        HDFC Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="citi" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        CITI Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="rbl" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        RBL Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="yes" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        YES Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="kotak" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Kotak Mahindra
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="americanExpress" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        American Express
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="standardCharted" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Standard Charted
                                                                    </label>
                                                                </div> -->
                                                            </div>
                                                        </div>
                                                        <div class="select-fields mb-4">
                                                            <h6 class="mb-4"> Select Date Range</h6>
                                                            <input type="date" class="form-input" id="from-date">
                                                            <span class="text-muted mx-2">To</span>
                                                            <input type="date" class="form-input" id="to-date">

                                                        </div>
                                                        <div class="select-fields mb-4">
                                                            <h5 class="mb-4">Select exclude Banks</h5>
                                                            <div class="row align-items-center">
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="all-ex" name="selectAllBanks-ex">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Select All
                                                                    </label>
                                                                </div>
                                                                <% for(let i=0; i < allBanks.length; i++) {%>
                                                                    <div class="col-2 form-check m-3">
                                                                        <input class="form-check-input" type="checkbox"
                                                                            value="<%=allBanks[i]['bank_short_value']%>"
                                                                            name="selectBanks-ex">
                                                                        <label class="form-check-label"
                                                                            for="flexCheckDefault">
                                                                            <%=allBanks[i]['bank_name'] %>
                                                                        </label>
                                                                    </div>
                                                                    <%}%>
                                                                        <!-- <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="bob" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        BOB
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="sbi" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        SBI
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="icici" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        ICICI Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="au" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        AU Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="indusind" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        IndusInd
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="idfc" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        IDFC Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="hdfc" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        HDFC Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="citi" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        CITI Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="rbl" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        RBL Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="yes" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        YES Bank
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="kotak" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Kotak Mahindra
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="americanExpress" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        American Express
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="standardCharted" name="selectBanks">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Standard Charted
                                                                    </label>
                                                                </div> -->
                                                            </div>
                                                        </div>
                                                        <div class="select-fields mb-4">
                                                            <h5 class="mb-4">Select Banks(For pin code option)</h5>
                                                            <div class="row align-items-center">
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="radio"
                                                                        value="none" name="selectBanks-for-pincode">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        none
                                                                    </label>
                                                                </div>
                                                                <% for(let i=0; i < allBanks.length; i++) {%>
                                                                    <div class="col-2 form-check m-3">
                                                                        <input class="form-check-input" type="radio"
                                                                            value="<%=allBanks[i]['bank_short_value']%>"
                                                                            name="selectBanks-for-pincode">
                                                                        <label class="form-check-label"
                                                                            for="flexCheckDefault">
                                                                            <%=allBanks[i]['bank_name'] %>
                                                                        </label>
                                                                    </div>
                                                                    <%}%>
                                                            </div>
                                                        </div>
                                                        <div class="select-fields mb-4">
                                                            <h5 class="mb-4">Select PIN code status</h5>
                                                            <div class="row align-items-center">
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="all" name="selectAllPinCodeStatus">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Select All
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="null" name="selectPinCodeStatus">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        null
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="true" name="selectPinCodeStatus">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        true
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="false" name="selectPinCodeStatus">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        false
                                                                    </label>
                                                                </div>
                                                             

                                                            </div>
                                                        </div>
                                                        <!-- select sms fields here... -->

                                                        <div class="select-fields mb-4">
                                                            <h5 class="mb-4">Select Number Fields</h5>
                                                            <div class="row align-items-center">
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="all" name="selectAllFields">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Select All
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="empty" name="selectFields">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Empty
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="Delivered" name="selectFields">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Delivered
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="Failed" name="selectFields">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Failed
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="NDNC Number" name="selectFields">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        NDNC Number
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="Blocked Number" name="selectFields">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Blocked
                                                                    </label>
                                                                </div>
                                                                <div class="col-2 form-check m-3">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        value="Pending" name="selectFields">
                                                                    <label class="form-check-label"
                                                                        for="flexCheckDefault">
                                                                        Pending
                                                                    </label>
                                                                </div>

                                                            </div>
                                                        </div>

                                                        <!-- Form filled tab here..... -->
                                                        <div id="js-all-banks-forms">


                                                        </div>







                                                        <!-- <div class="select-fields mb-4">
                                                            <h5 class="mb-4">Form Filled</h5>
                                                            <div class="row align-items-center">
                                                                <ul class="nav nav-pills mb-3" id="pills-tab"
                                                                    role="tablist">
                                                                    <li class="nav-item" role="presentation">
                                                                        <button class="nav-link active"
                                                                            id="pills-home-tab" data-bs-toggle="pill"
                                                                            data-bs-target="#pills-home" type="button"
                                                                            role="tab" aria-controls="pills-home"
                                                                            aria-selected="true">User Segment</button>
                                                                    </li>
                                                                    <li class="nav-item" role="presentation">
                                                                        <button class="nav-link" id="pills-profile-tab"
                                                                            data-bs-toggle="pill"
                                                                            data-bs-target="#pills-profile"
                                                                            type="button" role="tab"
                                                                            aria-controls="pills-profile"
                                                                            aria-selected="false">Topics</button>
                                                                    </li>

                                                                </ul>
                                                                <div class="tab-content col-md-6" id="pills-tabContent">
                                                                    <div class="tab-pane fade show active"
                                                                        id="pills-home" role="tabpanel"
                                                                        aria-labelledby="pills-home-tab">
                                                                        <label for="" class="form-label">Select User
                                                                            Segments</label>
                                                                        <select class="form-select"
                                                                            aria-label="Select User Segments"
                                                                            id="userSegmentFurtherForm">
                                                                            <option value="0" selected>Select User
                                                                                Segments</option>
                                                                            <option value="1">Send With FCM Token
                                                                            </option>
                                                                            <option value="2">Send To Devices</option>
                                                                        </select>
                                                                        <div class="g-4 m-2" id="furtherFormData"></div>
                                                                    </div>
                                                                    <div class="tab-pane fade" id="pills-profile"
                                                                        role="tabpanel"
                                                                        aria-labelledby="pills-profile-tab">
                                                                        <label for="" class="form-label">Select Message
                                                                            Topics*</label>
                                                                        <select class="form-select"
                                                                            aria-label="Select Message Topics"
                                                                            id="topicsSegmentFurtherForm">
                                                                            <option value="0" selected>Select Message
                                                                                Topics</option>
                                                                            <option value="1">Credit Cards Topics
                                                                            </option>
                                                                            <option value="2">Card Issuers Topics
                                                                            </option>
                                                                        </select>
                                                                        <div class="g-4 m-2" id="topicsFurther">

                                                                        </div>
                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </div> -->


                                                    </form>
                                                </div>

                                                <!-- <select id="inputState" onchange=" FILEUPLOADDATA.selectedStatus(this)"
                                                    class="form-select">
                                                    <option selected="">filter by ...</option>
                                                    <option value="Delivered">Delivered</option>
                                                    <option value="NDNC Number">NDNC Number</option>
                                                    <option value="Failed">Failed</option>
                                                </select> -->
                                                <!-- <div class="choose-file" style="display: inline-block;">
                                                            <input type="file" id="fileUpload" />
                                                        </div> -->

                                                <div class="upload btn" style="display: inline-block;">
                                                    <input type="button" id="upload" value="Export all Data" />
                                                </div>
                                                <div class="upload btn" style="display: inline-block;">
                                                    <input type="button" id="getPhoneNum" value="Export only phone " />
                                                </div>
                                                <div class="upload btn" style="display: inline-block;">
                                                    <input type="button" id="getPhoneByFacebook"
                                                        value="Export Facebook Data " />
                                                </div>
                                                <!-- <div class="upload btn" style="display: inline-block;">
                                                    <input type="button" id="uploadAxis" value="Export axis Data" />
                                                </div>
                                                <div class="upload btn" style="display: inline-block;">
                                                    <input type="button" id="uploadBob" value="Export bob Data" />
                                                </div> -->
                                                <br>
                                                <p id="errorShow"></p>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Javascripts -->
            <script src="/./app/utils/assets/plugins/jquery/jquery-3.5.1.min.js"></script>
            <script src="/./app/utils/assets/plugins/bootstrap/js/popper.min.js"></script>
            <script src="/./app/utils/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
            <script src="/./app/utils/assets/plugins/perfectscroll/perfect-scrollbar.min.js"></script>
            <script src="/./app/utils/assets/plugins/pace/pace.min.js"></script>
            <script src="/./app/utils/assets/plugins/highlight/highlight.pack.js"></script>
            <script src="/./app/utils/assets/plugins/dropzone/min/dropzone.min.js"></script>
            <script src="/./app/utils/assets/js/main.min.js"></script>
            <script src="/./app/utils/assets/js/custom.js"></script>


</body>

</html>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/xlsx.full.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/jszip.js"></script>

<script>
    let FILEUPLOADDATA = {};
    FILEUPLOADDATA.allApplications = [];
    FILEUPLOADDATA.exlSheetData = [];
    FILEUPLOADDATA.matchedUserData = [];

    FILEUPLOADDATA.selectedStatusValue = '';

    FILEUPLOADDATA.allBankSelected = false;
    FILEUPLOADDATA.allBanksArray = [];
    FILEUPLOADDATA.allBankSelectedEx = false;
    FILEUPLOADDATA.allBanksArrayEx = [];
    FILEUPLOADDATA.allNumberFieldsSelected = false;
    FILEUPLOADDATA.allNumberFieldsArray = [];
    FILEUPLOADDATA.allAppliedSelectedByBank = {};
    FILEUPLOADDATA.allNumberAppliedArraybyBank = {};
    FILEUPLOADDATA.appliedSelectedByBank = [];
    FILEUPLOADDATA.notAppliedSelectedByBank = [];
    FILEUPLOADDATA.pinCodeStatus = [];
    FILEUPLOADDATA.bankForpinCodeOption  = '';
    let requestFor = '';

    $(document).ready(() => {


        $("#loader").hide();
        $('#loader').bind('ajaxStart', function () {
            $(this).show();
        }).bind('ajaxStop', function () {
            $(this).hide();
        });

        $('input[name= "selectAllFields"]').click(function () {
            var checked = this.checked;
            FILEUPLOADDATA.allNumberFieldsSelected = checked;
            FILEUPLOADDATA.allNumberFieldsArray = [];
            $('input[name="selectFields"]').each(function () {
                let currentValue = $(this).val();

                this.checked = checked;
                if (checked) {
                    FILEUPLOADDATA.allNumberFieldsArray.push(currentValue);
                }
            });
            console.log(FILEUPLOADDATA.allNumberFieldsArray, "FILEUPLOADDATA.allNumberFieldsArray");
        });
        $('input[name= "formFilledNotApplied"]').click(function () {
            var checked = this.checked;
            FILEUPLOADDATA.notAppliedSelected = checked;
        });
        $('input[name="selectFields"]').click(function () {
            let checkAllChecked = FILEUPLOADDATA.toggleCheckedBox(this, 'selectAllFields', 'selectFields');
            FILEUPLOADDATA.allNumberFieldsSelected = checkAllChecked.allSelected;
            FILEUPLOADDATA.allNumberFieldsArray = checkAllChecked.selectedItems;
        });
        $('input[name= "selectAllBanks"]').click(function () {
            var checked = this.checked;
            FILEUPLOADDATA.allBankSelected = checked;
            FILEUPLOADDATA.allBanksArray = [];
            $('input[name="selectBanks"]').each(function () {
                let currentValue = $(this).val();
                this.checked = checked;
                if (checked) {
                    FILEUPLOADDATA.allBanksArray.push(currentValue);
                    if (!$("#bank-form-" + currentValue).length) {
                        //console.log("Checked ", currentValue);
                        $('#js-all-banks-forms').append(FILEUPLOADDATA.makeFurtherHtmlForm(currentValue));
                        $('input[name= appliedFieldsFurtherAll_' + currentValue + ']').prop('checked', true);
                        FILEUPLOADDATA.selectAllAppliedFieldsByBank(this, currentValue);
                    }
                } else {
                    FILEUPLOADDATA.selectAllAppliedFieldsByBank(this, currentValue);
                    $('input[name= appliedFieldsFurtherAll_' + currentValue + ']').prop('checked', false);
                    $("#bank-form-" + currentValue).remove();
                    delete FILEUPLOADDATA.allNumberAppliedArraybyBank[currentValue];
                    console.log(FILEUPLOADDATA.allNumberAppliedArraybyBank, "GGGGGGGG ALL");
                }


            });
            console.log(FILEUPLOADDATA.allBanksArray, 'HI ');
        });
        $('input[name= "selectBanks-for-pincode"]').click(function () {
            var checked = this.checked;
            let currentValue = $(this).val();
            console.log(checked , currentValue);
            FILEUPLOADDATA.bankForpinCodeOption = currentValue;
            //FILEUPLOADDATA.pinCodeStatus = [];
           
        });
        $('input[name= "selectAllPinCodeStatus"]').click(function () {
            var checked = this.checked;
            FILEUPLOADDATA.pinCodeStatus = [];
           
            $('input[name="selectPinCodeStatus"]').each(function () {
                let currentValue = $(this).val();
                this.checked = checked;
                if ( this.checked){
                    FILEUPLOADDATA.pinCodeStatus.push(currentValue);
                  
                }
            })
            console.log(FILEUPLOADDATA.pinCodeStatus, 'selectAllPinCodeStatus ');
        });
        $('input[name= "selectPinCodeStatus"]').click(function () {
            var checked = this.checked;
            let checkAllChecked = true;
            FILEUPLOADDATA.pinCodeStatus = [];
            $('input[name="selectPinCodeStatus"]').each(function () {
                let currentValue = $(this).val();
                if ( this.checked){
                    FILEUPLOADDATA.pinCodeStatus.push(currentValue);
                  
                } else {
                    checkAllChecked = false
                }

            })
            $('input[name= selectAllPinCodeStatus]').prop('checked', checkAllChecked);
           
            console.log(FILEUPLOADDATA.pinCodeStatus, 'selectPinCodeStatus ');
        });
        $('input[name="selectBanks"]').click(function () {
            let checked = this.checked;
            let checkAllChecked = FILEUPLOADDATA.toggleCheckedBox(this, 'selectAllBanks', 'selectBanks');
            let currentValue = $(this).val();

            FILEUPLOADDATA.selectAllAppliedFieldsByBank(this, currentValue);
            if (checked) {
                $('input[name= appliedFieldsFurtherAll_' + currentValue + ']').prop('checked', true);
            } else {
                $('input[name= appliedFieldsFurtherAll_' + currentValue + ']').prop('checked', false);
            }
            FILEUPLOADDATA.allBankSelected = checkAllChecked.allSelected;
            FILEUPLOADDATA.allBanksArray = checkAllChecked.selectedItems;
            console.log(FILEUPLOADDATA.allBanksArray, 'HI GGGG ');
        });

        $('input[name= "selectAllBanks-ex"]').click(function () {
            var checked = this.checked;
            // FILEUPLOADDATA.allBankSelected = checked;
            // FILEUPLOADDATA.allBanksArray = [];
            FILEUPLOADDATA.allBankSelectedEx = checked;
            FILEUPLOADDATA.allBanksArrayEx = [];
            $('input[name="selectBanks-ex"]').each(function () {
                let currentValue = $(this).val();
                this.checked = checked;
                if (checked) {
                    FILEUPLOADDATA.allBanksArrayEx.push(currentValue);

                }
                //else {

                // }


            });
            console.log(FILEUPLOADDATA.allBanksArrayEx, 'HI ');
        });
        $('input[name="selectBanks-ex"]').click(function () {
            let checked = this.checked;
            let checkAllChecked = FILEUPLOADDATA.toggleCheckedBox(this, 'selectAllBanks-ex', 'selectBanks-ex');
            let currentValue = $(this).val();
            FILEUPLOADDATA.allBankSelectedEx = checkAllChecked.allSelected;
            FILEUPLOADDATA.allBanksArrayEx = checkAllChecked.selectedItems;

            // FILEUPLOADDATA.allBankSelected = checkAllChecked.allSelected;
            // FILEUPLOADDATA.allBanksArray = checkAllChecked.selectedItems;
            console.log(FILEUPLOADDATA.allBanksArrayEx, 'HI GGGG ');
        });

        $('input[name= "appliedFieldsFurtherAll"]').click(function () {
            var checked = this.checked;
            FILEUPLOADDATA.allAppliedSelected = checked;
            FILEUPLOADDATA.allNumberAppliedArray = [];
            $('input[name="appliedFieldsFurther"]').each(function () {
                let currentValue = $(this).val();
                this.checked = checked;
                if (checked) {
                    FILEUPLOADDATA.allNumberAppliedArray.push(currentValue);
                }
            });
        });

        $('input[name= "appliedFieldsFurther"]').click(function () {
            let checkAllChecked = FILEUPLOADDATA.toggleCheckedBox(this, 'appliedFieldsFurtherAll', 'appliedFieldsFurther');
            FILEUPLOADDATA.allAppliedSelected = checkAllChecked.allSelected;
            FILEUPLOADDATA.allNumberAppliedArray = checkAllChecked.selectedItems;
        });

    });
    FILEUPLOADDATA.appliedToggle = function (currentElement, bankName) {
        if ($(currentElement).is(':checked')) {
            // Do something...
            console.log("applied checked now ");
            FILEUPLOADDATA.appliedSelectedByBank.push(bankName);
            $("#formFieldNotAppliedFurther-" + bankName).removeClass('common-hide');
        } else {
            $("#formFieldNotAppliedFurther-" + bankName).addClass('common-hide');
            let newListArray = [];
            if (FILEUPLOADDATA.appliedSelectedByBank.length > 0) {
                for (let k = 0; k < FILEUPLOADDATA.appliedSelectedByBank.length > 0; k++) {
                    if (FILEUPLOADDATA.appliedSelectedByBank[k] != bankName) {
                        newListArray.push(bankName);
                    }

                }
            }
            FILEUPLOADDATA.appliedSelectedByBank = newListArray;
        }

    }
    FILEUPLOADDATA.notAppliedToggle = function (currentElement, bankName) {
        if ($(currentElement).is(':checked')) {
            // Do something...
            console.log("applied checked now ");
            FILEUPLOADDATA.notAppliedSelectedByBank.push(bankName);
        } else {
            let newListArray = [];
            if (FILEUPLOADDATA.notAppliedSelectedByBank.length > 0) {
                for (let k = 0; k < FILEUPLOADDATA.notAppliedSelectedByBank.length > 0; k++) {
                    if (FILEUPLOADDATA.notAppliedSelectedByBank[k] != bankName) {
                        newListArray.push(bankName);
                    }

                }
            }
            FILEUPLOADDATA.notAppliedSelectedByBank = newListArray;
        }
    }
    FILEUPLOADDATA.selectAllAppliedFieldsByBank = function (currentElement, bankName) {
        var checked = currentElement.checked;
        FILEUPLOADDATA.allAppliedSelectedByBank[bankName] = checked;
        FILEUPLOADDATA.allNumberAppliedArraybyBank[bankName] = [];
        $('input[name="appliedFieldsFurther_' + bankName + '"]').each(function () {
            let currentValue = $(this).val();
            this.checked = checked;
            if (checked) {
                FILEUPLOADDATA.allNumberAppliedArraybyBank[bankName].push(currentValue);
            }
        });

    }
    FILEUPLOADDATA.selectAppliedFieldsValueByBank = function (currentElement, bankName) {

        let checkAllChecked = FILEUPLOADDATA.toggleCheckedBox(currentElement, 'appliedFieldsFurtherAll_' + bankName, 'appliedFieldsFurther_' + bankName);
        FILEUPLOADDATA.allAppliedSelectedByBank[bankName] = checkAllChecked.allSelected;
        FILEUPLOADDATA.allNumberAppliedArraybyBank[bankName] = checkAllChecked.selectedItems;
    }
    FILEUPLOADDATA.toggleCheckedBox = function (currentElement, sellectAllName, allChildName) {
        let checkAllChildChecked = true;
        let returnData = {
            allSelected: true,
            selectedItems: [],
        };
        let currentSelected = $(currentElement).is(':checked');
        //if ($(currentElement).is(':checked')) {

        $('input[name="' + allChildName + '"]').each(function () {

            if (!$(this).is(':checked')) {
                checkAllChildChecked = false;
                let currentValue = $(this).val();
                if (allChildName == 'selectBanks') {
                    //console.log("notChecked ", currentValue);
                    delete FILEUPLOADDATA.allNumberAppliedArraybyBank[currentValue];
                    console.log(FILEUPLOADDATA.allNumberAppliedArraybyBank, "remove single");
                    $("#bank-form-" + currentValue).remove();
                }

            } else {
                console.log($(this).is(':checked'), "CCCCCCCCCC");
                let currentValue = $(this).val();
                if (allChildName == 'selectBanks') {
                    if (!$("#bank-form-" + currentValue).length) {
                        //console.log("Checked ", currentValue);
                        $('#js-all-banks-forms').append(FILEUPLOADDATA.makeFurtherHtmlForm(currentValue));
                    }

                }

                returnData.selectedItems.push(currentValue);
                //console.log('value', currentValue);
            }
        });
        if (checkAllChildChecked) {
            $('input[name= "' + sellectAllName + '"]').prop('checked', true);

        } else {
            $('input[name= "' + sellectAllName + '"]').prop('checked', false);
        }
        // } else {
        //     checkAllChildChecked = false;
        //     if (allChildName == 'selectBanks') {
        //         let currentValue = $(currentElement).val();
        //         $("#bank-form-" + currentValue).remove();
        //     }

        //     $('input[name= "' + sellectAllName + '"]').prop('checked', false);
        // }
        returnData.allSelected = checkAllChildChecked;
        console.log(returnData, "returnData");
        return returnData;
    }

    $("#from-date").change(function () {
        let fromDate = $(this).val();
        let toDate = $("#to-date").val();
        console.log(fromDate, "fromDatefromDate");
        // if (fromDate > toDate) {
        //     $("#to-date").val(fromDate);
        // }
    });
    $("#to-date").change(function () {
        let fromDate = $("#from-date").val();
        let toDate = $(this).val();
        console.log(toDate, "toDatetoDate");
    });

    $("body").on("click", "#upload", function () {
        $("#loader").show();
        //Reference the FileUpload element.
        // window.location.href = "/applications/get-filtered-application-ajax?status=" + FILEUPLOADDATA
        //     .selectedStatusValue;
        FILEUPLOADDATA.checkDataAccordingToNeed();
        requestFor = '';
        $("#loader").hide();
    });
    $("body").on("click", "#getPhoneByFacebook", function () {
        $("#loader").show();
        requestFor = 'phFb';
        //Reference the FileUpload element.
        // window.location.href = "/applications/get-filtered-application-ajax?status=" + FILEUPLOADDATA
        //     .selectedStatusValue;
        FILEUPLOADDATA.checkDataAccordingToNeed();
        $("#loader").hide();
    });
    $("body").on("click", "#getPhoneNum", function () {
        $("#loader").show();
        requestFor = 'ph';
        //Reference the FileUpload element.
        // window.location.href = "/applications/get-filtered-application-ajax?status=" + FILEUPLOADDATA
        //     .selectedStatusValue;
        FILEUPLOADDATA.checkDataAccordingToNeed();
        $("#loader").hide();
    });
    // ("body").on("click" , "#getPhoneNum", function () {
    //     $("#loader").show();
    //     //Reference the FileUpload element.
    //     // window.location.href = "/applications/get-filtered-application-ajax?status=" + FILEUPLOADDATA
    //     //     .selectedStatusValue;
    //     FILEUPLOADDATA.checkDataAccordingToNeed();
    //     $("#loader").hide();
    // });
    // $("body").on("click", "#uploadAxis", function () {
    //     $("#loader").show();
    //     //Reference the FileUpload element.
    //     window.location.href = "/applications/get-filtered-application-ajax?for=axis&status=" + FILEUPLOADDATA
    //         .selectedStatusValue;
    //     //FILEUPLOADDATA.entryToDb();
    //     $("#loader").hide();
    // });
    $("body").on("click", "#uploadBob", function () {
        $("#loader").show();
        //Reference the FileUpload element.
        window.location.href = "/applications/get-filtered-application-ajax?for=bob&status=" + FILEUPLOADDATA
            .selectedStatusValue;
        //FILEUPLOADDATA.entryToDb();
        $("#loader").hide();
    });
    FILEUPLOADDATA.selectedStatus = function (element) {
        let value = $(element).find(":selected").text();
        FILEUPLOADDATA.selectedStatusValue = value;
        console.log(value, "valuevalue");

    }

    FILEUPLOADDATA.checkDataAccordingToNeed = async function () {

        console.log('HI I AM IN THIS');
        let returnResult = false;
        if (FILEUPLOADDATA.allBankSelected || FILEUPLOADDATA.allBanksArray.length > 0) {
            if (FILEUPLOADDATA.allNumberFieldsSelected || FILEUPLOADDATA.allNumberFieldsArray.length > 0) {
                let sendData = {};
                sendData.isAllSelectedBank = FILEUPLOADDATA.allBankSelected;
                sendData.allSelectedBanksArray = FILEUPLOADDATA.allBanksArray;
                sendData.isAllSelectedBankEx = FILEUPLOADDATA.allBankSelectedEx;
                sendData.allSelectedBanksArrayEx = FILEUPLOADDATA.allBanksArrayEx;
                sendData.allNumberFieldsSelected = FILEUPLOADDATA.allNumberFieldsSelected;
                sendData.allNumberFieldsArray = FILEUPLOADDATA.allNumberFieldsArray;

                // sendData.notAppliedStatus = FILEUPLOADDATA.notAppliedSelectedByBank;
                // sendData.appliedStatus = FILEUPLOADDATA.appliedSelectedByBank;

                if (!jQuery.isEmptyObject(FILEUPLOADDATA.allAppliedSelectedByBank) || !jQuery.isEmptyObject(FILEUPLOADDATA.allNumberAppliedArraybyBank)) {
                    let allOkInApply = true;
                    for (let bl = 0; bl < FILEUPLOADDATA.allBanksArray.length; bl++) {
                        console.log(FILEUPLOADDATA.allAppliedSelectedByBank[FILEUPLOADDATA.allBanksArray[bl]]);
                        console.log(FILEUPLOADDATA.allNumberAppliedArraybyBank[FILEUPLOADDATA.allBanksArray[bl]], FILEUPLOADDATA.allNumberAppliedArraybyBank[FILEUPLOADDATA.allBanksArray[bl]].length)
                        if (!FILEUPLOADDATA.allAppliedSelectedByBank[FILEUPLOADDATA.allBanksArray[bl]]) {

                            if (!FILEUPLOADDATA.allNumberAppliedArraybyBank[FILEUPLOADDATA.allBanksArray[bl]] || FILEUPLOADDATA.allNumberAppliedArraybyBank[FILEUPLOADDATA.allBanksArray[bl]].length == 0) {
                                allOkInApply = false;
                            }
                        }
                    }
                    sendData.formAppliedFilterAll = FILEUPLOADDATA.allAppliedSelectedByBank;
                    sendData.formAppliedFilterArray = FILEUPLOADDATA.allNumberAppliedArraybyBank;
                    console.log(sendData, "sendData");
                    if (allOkInApply) {
                        let fromDate = $("#from-date").val();
                        let toDate = $("#to-date").val();
                        console.log('HI I AM IN THIS', fromDate, toDate);
                        sendData.fromDate = fromDate;
                        sendData.toDate = toDate;
                        sendData.pinCodeStatus = FILEUPLOADDATA.pinCodeStatus;
                        sendData.bankForpinCodeOption = FILEUPLOADDATA.bankForpinCodeOption;
                        await FILEUPLOADDATA.entryToDb(sendData);
                    } else {
                        alert('Please select form applied for all selected bank');
                    }
                    //FILEUPLOADDATA.entryToDb(sendData);
                } else {
                    alert('Please select form applied');
                }

            } else {
                alert('Please select Number field')
            }
        } else {
            alert('Please select bank')
        }

        //return returnResult;
    }
    const saveData = (function () {
        const a = document.createElement("a");
        document.body.appendChild(a);
        a.style = "display: none";
        return function (data, fileName) {
            const blob = new Blob([data], { type: "octet/stream" }),
                url = window.URL.createObjectURL(blob);
            a.href = url;
            a.download = fileName;
            a.click();
            window.URL.revokeObjectURL(url);
        };
    }());
    FILEUPLOADDATA.entryToDb = async function (dataToSend) {
        // console.log(dataToSend);
        // $('#loader-overlay').addClass('loader-display');
        $('#loader').bind('ajaxStart', function () {
            $(this).show();
        }).bind('ajaxStop', function () {
            $(this).hide();
        });

        // $('#loader').show();
        await $.ajax({
            url: "/applications/get-filtered-application-ajax",
            type: "POST",
            // contentType: "application/jsonrequest",
            // dataType: 'json',
            data: { "allData": JSON.stringify(dataToSend), "requestFor": requestFor },
        }).done(function (result) {
            //  $('#loader').hide();
            console.log("sdfbiunvuenuinb");
            saveData(result, "cardinsider_sms_sheet.csv");
        });


    }

    FILEUPLOADDATA.makeFurtherHtmlForm = function (bankName) {
        return `<div class="` + bankName + `-form-filled" id= "bank-form-` + bankName + `">


<!-- further form for form filed not applied  -->
<div id="formFieldNotAppliedFurther-`+ bankName + `" >
    <div class="select-form-filled mb-4">
        <h5 class="mb-4">`+ bankName + ` Form Applied</h5>
        <div class="row align-items-center">
            <div class="col-2 form-check m-3">
                <input class="form-check-input"
                    type="checkbox" value="all" onchange = "FILEUPLOADDATA.selectAllAppliedFieldsByBank(this , '`+ bankName + `')"
                    name="appliedFieldsFurtherAll_`+ bankName + `">
                <label class="form-check-label"
                    for="flexCheckDefault">
                    Select All
                </label>
            </div>
            <div class="col-2 form-check m-3">
                <input class="form-check-input"
                    type="checkbox" value="IPA Approved" onchange = "FILEUPLOADDATA.selectAppliedFieldsValueByBank(this , '`+ bankName + `')"
                    name="appliedFieldsFurther_`+ bankName + `">
                <label class="form-check-label"
                    for="flexCheckDefault">
                    IPA Approved
                </label>
            </div>
            <div class="col-2 form-check m-3">
                <input class="form-check-input"
                    type="checkbox" value="Rejected"  onchange = "FILEUPLOADDATA.selectAppliedFieldsValueByBank(this , '`+ bankName + `')"
                    name="appliedFieldsFurther_`+ bankName + `">
                <label class="form-check-label"
                    for="flexCheckDefault">
                    Rejected
                </label>
            </div>
            <div class="col-2 form-check m-3">
                <input class="form-check-input"
                    type="checkbox" value="Pending"  onchange = "FILEUPLOADDATA.selectAppliedFieldsValueByBank(this , '`+ bankName + `')"
                    name="appliedFieldsFurther_`+ bankName + `">
                <label class="form-check-label"
                    for="flexCheckDefault">
                    Pending
                </label>
            </div>
            <div class="col-2 form-check m-3">
                <input class="form-check-input"
                    type="checkbox" value="In Complete"  onchange = "FILEUPLOADDATA.selectAppliedFieldsValueByBank(this , '`+ bankName + `')"
                    name="appliedFieldsFurther_`+ bankName + `">
                <label class="form-check-label"
                    for="flexCheckDefault">
                    In Complete
                </label>
            </div>
            <div class="col-2 form-check m-3">
                <input class="form-check-input"
                    type="checkbox" value="Approved"  onchange = "FILEUPLOADDATA.selectAppliedFieldsValueByBank(this , '`+ bankName + `')"
                    name="appliedFieldsFurther_`+ bankName + `">
                <label class="form-check-label"
                    for="flexCheckDefault">
                    Approved
                </label>
            </div>


        </div>
    </div>

</div>
</div>`;
    }
</script>